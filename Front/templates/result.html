{% extends 'layout.html' %}

{% block content %}
<div class="result-page">
    <div class="result-header">
        <h1>{{ _('Результаты распознавания') }}</h1>
        <p>{{ _('Проверьте и отредактируйте данные, извлеченные из файла') }} <strong>{{ filename }}</strong>.</p>
    </div>

    <div class="result-content-grid">
        <!-- Image Viewer -->
        <div class="main-card image-viewer-card">
            <div class="card-header">
                <h2>{{ _('Исходный документ') }}</h2>
            </div>
            <div class="image-container">
                <img src="{{ image_url }}" alt="{{ _('Загруженное изображение') }} {{ filename }}">
            </div>
        </div>

        <!-- Table Editor -->
        <div class="main-card table-editor-card">
            <div class="card-header">
                <h2>{{ _('Извлеченные данные') }}</h2>
                <div class="table-actions">
                    <button id="add-row-btn" class="btn-secondary">{{ _('Добавить строку') }}</button>
                    <button id="save-btn" class="btn-primary">{{ _('Сохранить и скачать Excel') }}</button>
                </div>
            </div>
            <div id="editable-table-wrapper">
                <!-- Editable table will be generated by JavaScript here -->
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
    // Передаем данные из Flask в JavaScript
    const tableData = {{ table_data|tojson|safe }};
    const downloadUrl = "{{ url_for('download', filename=filename) }}";
    const csrfToken = "{{ csrf_token() }}"; // Для будущих POST-запросов, если понадобится
</script>
<script src="{{ url_for('static', filename='js/result.js') }}"></script>
{% endblock %} 